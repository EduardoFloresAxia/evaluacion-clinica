<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal de Evaluación - Axia Desarrollo Humano</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .option-btn:checked + span { @apply bg-indigo-600 text-white border-indigo-600; }
        .sticky-header { position: sticky; top: 0; z-index: 50; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans pb-10">
    <div class="max-w-2xl mx-auto p-4">
        <header class="text-center my-8">
            <h1 class="text-3xl font-bold text-slate-900">Portal de Evaluación</h1>
            <p class="text-indigo-600 font-medium tracking-widest uppercase text-sm">Axia Desarrollo Humano</p>
        </header>

        <div class="bg-white p-6 rounded-2xl shadow-md border border-slate-200 mb-6 sticky-header">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-xs font-bold uppercase text-slate-500 mb-1">Iniciales</label>
                    <input type="text" id="iniciales" required class="w-full border rounded-lg p-2 outline-none focus:ring-2 focus:ring-indigo-400">
                </div>
                <div>
                    <label class="block text-xs font-bold uppercase text-slate-500 mb-1">Correo Electrónico</label>
                    <input type="email" id="correoCliente" required class="w-full border rounded-lg p-2 outline-none focus:ring-2 focus:ring-indigo-400" placeholder="cliente@correo.com">
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-xs font-bold uppercase text-slate-500 mb-1">Fecha</label>
                    <input type="date" id="fecha" class="w-full border rounded-lg p-2 outline-none">
                </div>
                <div>
                    <label class="block text-xs font-bold uppercase text-slate-500 mb-1">Prueba a Aplicar</label>
                    <select id="testSelector" class="w-full border rounded-lg p-2 bg-slate-50 font-medium cursor-pointer">
                        <option value="BAI">Ansiedad (BAI)</option>
                        <option value="BDI">Depresión (BDI-II)</option>
                        <option value="BHS">Desesperanza (BHS)</option>
                        <option value="AAQII">Aceptación y Acción (AAQ-II)</option>
                        <option value="BAFT">Fusión Cognitiva (BAFT)</option>
                    </select>
                </div>
            </div>
        </div>

        <form id="mainForm" class="space-y-4">
            <div id="preguntasContainer"></div>
            <button type="submit" id="submitBtn" class="w-full bg-indigo-600 text-white py-4 rounded-xl font-bold hover:bg-indigo-700 transition-all shadow-lg mt-6">
                Finalizar y Enviar Informe
            </button>
        </form>

        <footer class="mt-12 pt-8 border-t border-slate-200 text-center">
            <p class="text-[10px] text-slate-400 leading-relaxed uppercase tracking-tighter">
                Aviso de Privacidad: Los datos aquí recolectados se utilizan exclusivamente para la entrega de resultados clínicos por parte de Axia Desarrollo Humano y no serán compartidos con terceros.
            </p>
        </footer>
    </div>

    <script>
        const tests = {
            BAI: {
                name: "Inventario de Ansiedad de Beck (BAI)",
                options: ["0: No", "1: Leve", "2: Mod.", "3: Sev."],
                items: ["Torpe o entumecido", "Acalorado", "Temblor en las piernas", "Incapaz de relajarse", "Temor a que ocurra lo peor", "Mareado", "Latidos fuertes", "Inestable", "Asustado", "Nervioso", "Sensación de bloqueo", "Temblores en manos", "Inquieto", "Temor a perder el control", "Dificultad para respirar", "Temor a morir", "Sobresaltado", "Molestias digestivas", "Desvanecimiento", "Rubor facial", "Sudores"]
            },
            BDI: {
                name: "Inventario de Depresión de Beck (BDI-II)",
                options: ["0", "1", "2", "3"],
                items: ["Tristeza", "Pesimismo", "Fracaso", "Pérdida de Placer", "Culpa", "Castigo", "Disconformidad", "Autocrítica", "Pensamientos Suicidas", "Llanto", "Agitación", "Pérdida de Interés", "Indecisión", "Desvalorización", "Pérdida de Energía", "Sueño", "Irritabilidad", "Apetito", "Concentración", "Cansancio", "Interés Sexual"]
            },
            BHS: {
                name: "Escala de Desesperanza de Beck (BHS)",
                options: ["Falso", "Verdadero"],
                items: ["Miro el futuro con esperanza", "Podría darme por vencido", "Las cosas no serán así siempre", "No imagino mi vida en 10 años", "Tengo tiempo para mis metas", "Espero lograr lo que me interesa", "Mi futuro me parece oscuro", "Espero cosas buenas", "Es tonto querer algo", "El pasado me preparó bien", "El futuro será desagradable", "No espero lo que deseo", "Espero ser más feliz", "Las cosas no marchan como quisiera", "Tengo confianza en mi futuro", "Nunca consigo lo que quiero", "No obtendré satisfacción real", "El futuro es incierto", "Espero más tiempos buenos", "No merece la pena intentar"]
            },
            AAQII: {
                name: "Aceptación y Acción (AAQ-II)",
                options: ["1: Nunca", "2", "3", "4", "5", "6", "7: Siempre"],
                items: ["Recuerdos dolorosos dificultan mi vida", "Tengo miedo de mis sentimientos", "Me preocupa no controlar mis emociones", "Recuerdos me impiden una vida plena", "Emociones interfieren en mi vida", "Otros llevan su vida mejor que yo", "Recuerdos me quitan energía"]
            },
            BAFT: {
                name: "Fusión Cognitiva (BAFT)",
                options: ["1: Nunca", "2", "3", "4", "5", "6", "7: Siempre"],
                items: ["Pensamientos causan angustia", "Lucho contra mis pensamientos", "Pensamientos dicen cómo actuar", "Atrapado en mis pensamientos", "Mis pensamientos son la verdad", "Tengo que controlar pensamientos", "Me dejo llevar por pensamientos", "Pensamientos me impiden hacer cosas", "Tomo pensamientos en serio", "Mis pensamientos me controlan", "Alejo pensamientos que no me gustan", "Mis pensamientos me asustan", "Dicen que no soy buena persona", "Me esfuerzo por cambiarlos", "Dicen que el futuro será malo", "Siento que son peligrosos"]
            }
        };

        const selector = document.getElementById('testSelector');
        const container = document.getElementById('preguntasContainer');
        const fechaInput = document.getElementById('fecha');
        fechaInput.valueAsDate = new Date();

        function renderTest() {
            const testKey = selector.value;
            const test = tests[testKey];
            container.innerHTML = `<h2 class="text-xl font-bold mb-4 text-slate-700">${test.name}</h2>`;
            test.items.forEach((item, i) => {
                const div = document.createElement('div');
                div.className = "bg-white p-5 rounded-xl border border-slate-200 mb-4 shadow-sm";
                div.innerHTML = `
                    <p class="font-medium mb-3 text-sm">${i+1}. ${item}</p>
                    <div class="flex flex-wrap gap-2">
                        ${test.options.map((opt, v) => `
                            <label class="flex-1">
                                <input type="radio" name="p${i}" value="${v}" required class="hidden peer">
                                <span class="block text-center py-2 border rounded-lg cursor-pointer peer-checked:bg-indigo-600 peer-checked:text-white transition-all text-[10px] font-bold uppercase tracking-tighter">
                                    ${opt}
                                </span>
                            </label>
                        `).join('')}
                    </div>
                `;
                container.appendChild(div);
            });
            window.scrollTo(0,0);
        }

        selector.addEventListener('change', renderTest);
        renderTest();

        document.getElementById('mainForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            btn.disabled = true; btn.innerText = "Procesando...";

            const data = {
                test: tests[selector.value].name,
                iniciales: document.getElementById('iniciales').value,
                email: document.getElementById('correoCliente').value,
                fecha: document.getElementById('fecha').value,
                respuestas: tests[selector.value].items.map((item, i) => ({
                    pregunta: item, valor: new FormData(e.target).get(`p${i}`)
                }))
            };

            // URL DE TU SCRIPT DE GOOGLE AQUÍ ABAJO
            const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbw1QFMiflgMfz9t1SCn6aietSzxSK2wBtNUMO-3YgjLx9Ymi0TgdATu-n-wRZGLA7A9yQ/exec';

            try {
                await fetch(WEB_APP_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(data) });
                alert('¡Enviado! Eduardo Flores recibirá el reporte pronto.');
                location.reload();
            } catch (err) { alert('Error al enviar.'); }
            finally { btn.disabled = false; btn.innerText = "Finalizar y Enviar Informe"; }
        };
    </script>
</body>

</html>
